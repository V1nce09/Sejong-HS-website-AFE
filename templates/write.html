<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>세종고 통합 포털 - {{ grade }}학년 {{ classroom }}반 글쓰기</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">

    {% if session.get('user') %}
    <!-- 프로필: 이름 + 학번(또는 관리자) + 동작 메뉴 -->
    <div class="profile-mini" role="note" aria-label="사용자 프로필">
      <div class="avatar">{{ (session.get('display_name') or session.get('user'))[0] | upper }}</div>
      <div class="profile-text">
        <div class="profile-name">{{ session.get('display_name') or session.get('user') }}</div>
        <div class="profile-sub">
          {% if session.get('user') == 'admin' %}
            관리자
          {% else %}
            학번: {{ session.get('student_no') or '등록안됨' }}
          {% endif %}
        </div>
      </div>

      <!-- 점 버튼 및 드롭다운 -->
      <div class="profile-actions" aria-hidden="true">
        <button class="dots-btn" aria-label="메뉴" type="button">⋯</button>
        <div class="profile-dropdown" aria-hidden="true">
          <a href="{{ url_for('logout') }}" class="dropdown-item">로그아웃</a>
        </div>
      </div>
    </div>
    {% else %}
    <!-- 로그인 버튼 -->
    <a href="{{ url_for('login') }}" class="bottom-left-auth-btn">로그인</a>
    {% endif %}

    <!-- 좌측 패널 -->
    <aside class="sidebar">
      <a href="{{ url_for('main') }}" style="text-decoration: none;"><h2 style="color:#fff;margin:0 0 5px 0; font-size: 32px;">세종고 포털</h2></a>
      <p style="color:#ccc; margin:0 0 14px 0; font-size: 24px;">Sjh Portal</p>

      <div style="display: flex; align-items: center; margin-top: 40px;">
        <h3 style="color:#fff; margin:0; font-size: 20px;">내 클래스</h3>
        <button class="add-class-btn">+</button>
      </div>
      <hr style="border: none; border-top: 1px solid rgba(255,255,255,0.2); margin: 10px 0;">
      <ul id="my-classes-list" style="list-style: none; padding: 0; margin-top: 10px;">
        <!-- 동적으로 추가될 클래스 항목들 -->
        <!-- 예시: <li data-grade="1" data-classroom="1" class="my-class-item">1학년 1반</li> -->
      </ul>

    </aside>

    <!-- 중앙 -->
    <main class="class-detail-section">
      <div class="class-header" style="display: flex; justify-content: space-between; align-items: center; padding-right: 20px; margin-bottom: 10px;">
        <h1 style="padding-left: 40px;">{{ grade }}학년 {{ classroom }}반 글쓰기</h1>
      </div>
      <hr class="class-title-divider" style="border: none; border-top: 2px solid black; margin: 10px 0 20px 0; width: 80vw;">

      <form id="write-form" method="POST" style="padding-left: 40px; padding-right: 20px;">
        <div style="margin-bottom: 15px;">
          <label for="title" style="display: block; margin-bottom: 5px; font-weight: bold;">제목</label>
          <input type="text" id="title" name="title" style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;" required>
        </div>
        <div style="margin-bottom: 15px;">
          <label for="content" style="display: block; margin-bottom: 5px; font-weight: bold;">내용</label>
          <textarea id="content" name="content" rows="10" style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;" required></textarea>
        </div>
        <div style="text-align: right;">
          <button id="submit-post-btn" type="submit" style="background-color: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 1em;">작성 완료</button>
          <button type="button" onclick="history.back()" style="background-color: #f44336; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 1em; margin-left: 10px;">취소</button>
        </div>
      </form>
    </main>

</div>

<script src="{{ url_for('static', filename='js/main.js') }}?v={{ cache_buster }}" defer></script>
<script>
    document.getElementById('write-form').addEventListener('submit', function() {
        const submitButton = document.getElementById('submit-post-btn');
        submitButton.disabled = true;
        submitButton.textContent = '작성 중...';
    });
</script>
</body>
</html>