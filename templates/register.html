<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>회원가입</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="auth-container">
    <h1>회원가입</h1>

    {% if error %}
      <div class="error">{{ error }}</div>
    {% endif %}

    <p class="subtitle">시간표·급식 정보를 보기 위해 가입하세요. 간단한 정보만 필요합니다.</p>

    <form method="post" autocomplete="off" novalidate id="registerForm">
      <div class="input-group">
        <label>아이디
          <div class="field">
            <input name="userid" type="text" required autofocus placeholder="아이디를 입력하세요">
          </div>
        </label>
      </div>

      <div class="input-row">
        <label>비밀번호
          <div class="field has-toggle">
            <input id="pwd" name="password" type="password" required placeholder="비밀번호">
            <button type="button" class="toggle-btn" data-target="pwd" aria-label="비밀번호 표시">👁</button>
          </div>
        </label>

        <label>비밀번호 확인
          <div class="field has-toggle">
            <input id="pwd2" name="password2" type="password" required placeholder="비밀번호 확인">
            <button type="button" class="toggle-btn" data-target="pwd2" aria-label="비밀번호 표시">👁</button>
          </div>
        </label>
      </div>

      <div class="input-group">
        <label>학번
          <div class="field">
            <input id="student_no" name="student_no" type="text" inputmode="numeric" pattern="\d{5}" maxlength="5" placeholder="학번을 입력하세요 (5자리)">
          </div>
        </label>
      </div>

      <button type="submit" class="submit-btn">회원가입</button>
    </form>

    <p class="notice"><a href="{{ url_for('login') }}">로그인으로 이동</a></p>
  </div>

<script>
/* 비밀번호 표시 토글 */
document.querySelectorAll('.toggle-btn').forEach(btn=>{
  btn.addEventListener('click', ()=> {
    const id = btn.dataset.target;
    const inp = document.getElementById(id);
    if (!inp) return;
    inp.type = inp.type === 'password' ? 'text' : 'password';
    btn.textContent = inp.type === 'password' ? '👁' : '🙈';
  });
});

/* 학번 숫자만 허용 */
const sn = document.getElementById('student_no');
if (sn) {
  sn.addEventListener('input', ()=> {
    sn.value = sn.value.replace(/\D/g, '').slice(0,5);
  });
}

/* 클라이언트 측 간단한 체크(서버 검증은 유지) */
document.getElementById('registerForm').addEventListener('submit', function(e){
  const p = document.getElementById('pwd').value;
  const p2 = document.getElementById('pwd2').value;
  if (p !== p2) {
    e.preventDefault();
    alert('비밀번호가 일치하지 않습니다.');
    return false;
  }
  if (p.length < 4) {
    e.preventDefault();
    alert('비밀번호는 4자 이상이어야 합니다.');
    return false;
  }
});
</script>
</body>
</html>